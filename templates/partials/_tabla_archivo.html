<div class="seccion-contenido">
    <div class="encabezado-seccion">
        <div class="titulo-seccion">
            <h3>Archivos adjuntos</h3>
        </div>
        <div class="barra-busqueda">
            <span class="material-symbols-outlined">search</span>
            <input type="text" id="input-busqueda" placeholder="Buscar" />
        </div>
        <button class="btn-crea-carpeta btn-crea-carpeta-items" onclick="abrirModalEspecifico('modal-crear-carpeta')">
            <span class="material-symbols-outlined icono-20px">create_new_folder</span>
            Nueva Carpeta
        </button>
        <select id="filtro-tipo" class="anadir-filtro select-limpio">
            <option value="todos">Todos los tipos</option>
            <option value="pdf">PDF</option>
            <option value="imagen">Imágenes</option>
            <option value="video">Videos</option>
            <option value="documento">Documentos</option>
            <option value="hoja_calculo">Hojas de cálculo</option>
            <option value="presentacion">Presentaciones</option>
            <option value="audio">Audio</option>
            <option value="archivo">Comprimidos</option>
            <option value="codigo">Código</option>
            <option value="otro">Otros</option>
        </select>
        <select id="orden-fecha" class="anadir-filtro select-limpio">
            <option value="desc">Más recientes</option>
            <option value="asc">Más antiguos</option>
        </select>
        <button id="btn-cambiar-vista" class="btn-icono-tabla margen-izq-8" title="Cambiar vista">
            <span class="material-symbols-outlined">grid_view</span>
        </button>
    </div>

    <table class="tabla-archivos">
        <thead>
            <tr>
                <th class="col-casilla">
                    <input type="checkbox" id="checkbox-seleccionar-todo" />
                </th>
                <th class="col-nombre">Nombre del archivo</th>
                <th class="col-fecha">Fecha de subida</th>
                <th class="col-actualizado">Última actualización</th>
                <th class="col-subido-por">Subido por</th>
                <th class="col-acciones"></th>
            </tr>
        </thead>
        <tbody id="tabla-body">
            <!-- Carpetas -->
            {% for carpeta in carpetas %}
            <tr class="fila-archivo fila-carpeta" data-tipo="carpeta" data-id="{{ carpeta.id }}">
                <td><input type="checkbox" class="casilla-archivo casilla-carpeta" /></td>
                <td>
                    <a href="{{ url_for('main.index', carpeta_id=carpeta.id) }}" class="enlace-carpeta enlace-carpeta-bloque">
                        <div class="info-archivo">
                            <div class="icono-archivo icon-folder">
                                <span class="material-symbols-outlined">folder</span>
                            </div>
                            <div class="texto-archivo">
                                <span class="nombre">{{ carpeta.nombre }}</span>
                                <span class="tamano">{{ carpeta.tamano }}</span>
                            </div>
                        </div>
                    </a>
                </td>
                <td>{{ carpeta.fecha_creacion }}</td>
                <td>-</td>
                <td>
                    <div class="info-usuario">
                        <span class="material-symbols-outlined avatar-icon">account_circle</span>
                        <div class="detalles-usuario">
                            <span class="nombre-usuario">{{ current_user.nombre }}</span>
                            <span class="email-usuario">{{ current_user.correo }}</span>
                        </div>
                    </div>
                </td>
                <td>
                    <div class="acciones-tabla">
                        <button class="btn-icono-tabla btn-eliminar-carpeta" data-id="{{ carpeta.id }}"
                            title="Eliminar">
                            <span class="material-symbols-outlined">delete</span>
                        </button>
                        <a href="{{ url_for('files.descargar_carpeta', carpeta_id=carpeta.id) }}" class="btn-icono-tabla"
                            title="Descargar">
                            <span class="material-symbols-outlined">download</span>
                        </a>
                    </div>
                </td>
            </tr>
            {% endfor %}

            {% for archivo in archivos %}
            <tr class="fila-archivo" data-tipo="{{ archivo.tipo }}">
                <td><input type="checkbox" class="casilla-archivo" /></td>
                <td>
                    <div class="info-archivo">
                        {% if archivo.tipo == 'pdf' %}
                        <div class="icono-archivo icon-pdf">
                            <span class="material-symbols-outlined">picture_as_pdf</span>
                        </div>
                        {% elif archivo.tipo == 'imagen' %}
                        <div class="icono-archivo icon-img">
                            <span class="material-symbols-outlined">image</span>
                        </div>
                        {% elif archivo.tipo == 'video' %}
                        <div class="icono-archivo icon-video">
                            <span class="material-symbols-outlined">movie</span>
                        </div>
                        {% elif archivo.tipo == 'documento' or archivo.tipo == 'word' %}
                        <div class="icono-archivo icon-doc">
                            <span class="material-symbols-outlined">description</span>
                        </div>
                        {% elif archivo.tipo == 'hoja_calculo' or archivo.tipo == 'excel' %}
                        <div class="icono-archivo icon-sheet">
                            <span class="material-symbols-outlined">table_chart</span>
                        </div>
                        {% elif archivo.tipo == 'presentacion' or archivo.tipo == 'powerpoint' %}
                        <div class="icono-archivo icon-ppt">
                            <span class="material-symbols-outlined">slideshow</span>
                        </div>
                        {% elif archivo.tipo == 'audio' %}
                        <div class="icono-archivo icon-audio">
                            <span class="material-symbols-outlined">audio_file</span>
                        </div>
                        {% elif archivo.tipo == 'archivo' %}
                        <div class="icono-archivo icon-zip">
                            <span class="material-symbols-outlined">folder_zip</span>
                        </div>
                        {% elif archivo.tipo == 'codigo' %}
                        <div class="icono-archivo icon-code">
                            <span class="material-symbols-outlined">code</span>
                        </div>
                        {% else %}
                        <div class="icono-archivo icon-fig">
                            <span class="material-symbols-outlined">draft</span>
                        </div>
                        {% endif %}
                        <div class="texto-archivo">
                            <span class="nombre">{{ archivo.nombre }}</span>
                            <span class="tamano">{{ archivo.tamano }}</span>
                        </div>
                    </div>
                </td>
                <td>{{ archivo.fecha_subida }}</td>
                <td>{{ archivo.ultima_actualizacion }}</td>
                <td>
                    <div class="info-usuario">
                        <span class="material-symbols-outlined avatar-icon">account_circle</span>
                        <div class="detalles-usuario">
                            <span class="nombre-usuario">{{ current_user.nombre }}</span>
                            <span class="email-usuario">{{ current_user.correo }}</span>
                        </div>
                    </div>
                </td>
                <td>
                    <div class="acciones-tabla">
                        <button class="btn-icono-tabla btn-eliminar-trigger" data-id="{{ archivo.id }}"
                            title="Eliminar">
                            <span class="material-symbols-outlined">delete</span>
                        </button>
                        <a href="{{ url_for('files.descargar_archivo', archivo_id=archivo.id) }}" class="btn-icono-tabla"
                            title="Descargar" download><span class="material-symbols-outlined">download</span></a>
                    </div>
                </td>
            </tr>
            {% else %}
            {% if not carpetas %}
            <tr id="fila-sin-archivos">
                <td colspan="6" class="celda-sin-archivos">
                    No hay archivos subidos.
                </td>
            </tr>
            {% endif %}
            {% endfor %}
        </tbody>
    </table>
    </table>
</div>
</main>

<!-- Barra de Acciones Masivas -->
<div id="barra-acciones-masivas" class="barra-flotante barra-flotante-oculta">
    <div class="contenido-barra-flotante">
        <span id="contador-seleccionados" class="texto-contador">0 archivos
            seleccionados</span>
        <div class="acciones-flotantes">
            <button id="btn-descargar-multiples" class="btn-secundario btn-sm">
                <span class="material-symbols-outlined icono-18px">folder_zip</span>
